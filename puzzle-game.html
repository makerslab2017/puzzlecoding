<!DOCTYPE html>
<!--페이지로딩후 html 노출-->
<html lang="ko" class="no-js">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="icon/css/font-awesome.min.css">
  <link rel="stylesheet" href="css/style.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="css/jquery.bxslider.css" rel="stylesheet"/>
  <link rel="stylesheet" href="js/Swiper-3.3.1/dist/css/swiper.min.css">
  <link href="css/summernote.css" rel="stylesheet">
  <link rel="stylesheet" href="css/common.css">
  <script src="js/Swiper-3.3.1/dist/js/swiper.min.js"></script>
  <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
  <script src="js/aws-cognito-sdk.min.js"></script>
  <script src="js/amazon-cognito-identity.min.js"></script>
  <script src="js/aws-sdk.min.js"></script>
  <script src="js/aws-cognito-config.js"></script>
  <script src="js/custom.js"></script>
  <script type="text/javascript" src="https://www.google.com/jsapi"></script>
  <script src="js/jquery.bxslider/jquery.bxslider.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <script src="js/summernote.min.js"></script>
  <script src="js/summernote-ko-KR.js"></script>
  
  <script src="js/puzzle-game.js"></script>

  <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script> <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script> <![endif]-->
</head>
  <body>
    <!--페이지 시작-->
    <div id="page-wrapper">
    	
    	<div id="subpage-top" class="sky">
		 	<div id="subpage-top-wrap">
			 	<div class="index-area">
			 		<span><a href="puzzle-intro.html">퍼즐메이커</a></span>
			 		<span>
		              <i class="fa fa-angle-right" aria-hidden="true"></i>
		            </span>
			 		<span><a href="puzzle-game.html">퍼즐만들기</a></span>
			 	</div>
			 	<div class="title-area">
			 		<img src="img/gear.png" alt="톱니바퀴 이미지">
			 		<h1>퍼즐만들기</h1>
			 	</div>
			 	<div class="inst-area">
			 		<span>
			 		퍼즐크래프트는 자신이 코딩퍼즐 게임에서 활용할 수 있는 퍼즐을 자신이 직접 만들 수 있는 도구입니다.<br>본페이지에서 제공하는 앱을 통해 손쉽게 만들 수 있습니다.
			 		</span>
			 	</div>
		 	</div>
		 	<div class="bg-area">
		 	</div>
		 </div>
		 
      <!-- <div class="bg-blue row" style="min-height:300px;">
        <div class="container">
          <section class="banner-text col-md-10" style="max-width:100%">
            <p><a href="puzzle-intro.html">퍼즐메이커</a>
              <span>
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </span>
              <a href="puzzle-game.html">
              퍼즐만들기</a></p>
              <div class="title-area">
              	<img src="img/gear.png" alt="톱니바퀴 이미지">
	            <h2>
	             	 퍼즐만들기
	            </h2>
            </div>
            <p class="lh2">
              퍼즐크래프트는 자신이 코딩퍼즐 게임에서 활용할 수 있는 퍼즐을 자신이 직접 만들 수 있는 도구입니다. 본페이지에서 제공하는 앱을 통해 손쉽게 만들 수 있습니다.
            </p>
          </section>
        </div>
      </div> -->
      <div class="container puzzle-game">
        <div class="row">
          <!--
          <div class="col-sm-3">
            <section class="tip">
              <h2>!TIP</h2>
              <p>아래버튼을 클릭하시면</p>
              <p>팁 동영상을 보실 수 있습니다.</p>
              <ul>
                <li>
                  <div class="blue-circle">
                    <i class="fa fa-play"></i>
                  </div>
                  최대글자수 최대글
                </li>
                <li>
                  <div class="blue-circle">
                    <i class="fa fa-play"></i>
                  </div>
                  타일만들기
                </li>
                <li>
                  <div class="blue-circle">
                    <i class="fa fa-play"></i>
                  </div>
                  타일만들기
                </li>
                <li>
                  <div class="blue-circle">
                    <i class="fa fa-play"></i>
                  </div>
                  타일만들기
                </li>
                <li>
                  <div class="blue-circle">
                    <i class="fa fa-play"></i>
                  </div>
                  타일만들기
                </li>
                <li>
                  <div class="blue-circle">
                    <i class="fa fa-play"></i>
                  </div>
                  타일만들기
                </li>
                <li>
                  <div class="blue-circle">
                    <i class="fa fa-play"></i>
                  </div>
                  타일만들기
                </li>
                <li>
                  <div class="blue-circle">
                    <i class="fa fa-play"></i>
                  </div>
                  타일만들기
                </li>
              </ul>
            </section>
          </div>
          -->
          <div class="col-md-10 col-md-offset-1">
            <div class="making-puzzle">
                <label>퍼즐 만들기 순서</label>
                <p>1. 제목을 작성합니다.</p>
                <p>2. 퍼즐을 만들고 우측 상단의 임시저장 버튼을 눌러 화면에 맞춰 퍼즐을 임시저장합니다. <a href ="https://youtu.be/LR6RU8PvAfY" target="_blank" ><font color="blue">[퍼즐메이커 사용법]</font></a></p>
                <p>3. 퍼즐 내용을 입력하고 가장 아래 있는 업로드하기 버튼을 클릭합니다.</p>
                <p>* 퍼즐메이커 사용 및 퍼즐 업로드 시 인터넷 상태에 따라 지연될 수 있습니다. 잠시만 기다려주세요.</p>

              <label>퍼즐제목</label>
              <input id="title" type="text" placeholder="퍼즐의 제목을 써주세요!"></input>
              

              <div class="flex-box" style="justify-content: center; margin-top: 2em;">
                <div id="loading-area">
                  <div id="loading-wrap">
                    <div class="loader">
                      <div class="loader-icon">
                        <svg viewBox="0 0 50 50">
                          <path fill="#ddd" d="M43.935,25.145c0-10.318-8.364-18.683-18.683-18.683c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615c8.072,0,14.615,6.543,14.615,14.615H43.935z">
                          </path>
                        </svg>
                      </div>
                      <div class="text-area">
                        <h2>잠시만 기다려 주세요...</h2>
                      </div>
                      <div class="btn-area">
                        <span class="btn">닫기</span>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="webgl-content">
                  <div>
                    <div id="gameContainer" style="width: 1024px; height: 576px;"></div>
                  </div>
                </div>
              </div>

              
              <div class="text-html">
                <div class="flex-box">
                  <label>퍼즐내용</label>
                  <div class="flex-box-inner">
                    <!--<span>TEXT</span>-->
                    <span class="text-active">HTML</span>
                  </div>
                </div>
                <div id="summernote">
                </div>
                
                  <!--<textarea placeholder="소개글을 써주세요." style="display:none;"></textarea>-->
              </div>

              <div class="making-puzzle-game">
                <!--<p>다음 버튼을 누르면 퍼즐에디터가 나옵니다. 로딩시 시간이 소요될 수 있으니 기다려주세요.</p>
                <p>맨 왼쪽 메뉴 버튼을 누르면 메뉴 화면이 나옵니다.</p>
                <div class="main-about-coding-button" id="puzzle-editor-loader" style="margin: 20px auto;">퍼즐에디터 로드하기</div>-->
                
                <div id="fixed-popup">
                	<div id="fixed-popup-wrap">
                		<div class="icon">
                		</div>
                		<h1>죄송합니다.</h1>
                		<h1><span class="target"></span>에서는 지원되지 않는 기능입니다.</h1>
                		<span class="btn">뒤로 가기</span>
                	</div>
                </div>
              </div>
              
              <div class="functions">
                <!-- <div class="function-btns">
                    <img src="img/share.png" alt="공유하기 버튼">
                </div>
                <div class="function-btns">
                  <img src="img/save.png" alt="저장하기 버튼">
                </div>
                <div class="function-btns">
                  <img src="img/delete.png" alt="삭제하기 버튼">
                </div>
                <div class="function-btns" id="goto-gallery">
                    <i class="material-icons">view_list</i>
                </div> -->
                <button id="uploadPuzzle" type="submit">
                  <img src="img/upload.png" alt="업로드버튼" class="upload-origin">
                  <img src="img/upload_hover.png" alt="업로드버튼" class="upload-hover">
                    업로드 하기
                </button>
                  
                <script>
                  
                  $('#goto-gallery').on('click', function() {window.location.href = './gallery.html'; });
                  $('#uploadPuzzle').on('click', function() {

                    data = localStorage.getItem('latestEditedPuzzle');
                    if (data == null) {
                      swal("아직 퍼즐을 만들지 않았습니다. 먼저 퍼즐을 만들어주세요.")
                      return;
                    }
                    json_data = JSON.parse(data);
                    var item = {
                        title: $('#title').val(),
                        description: $('#summernote').summernote('code'),
                        public: true,
                        data: json_data
                    };
                    puzzleAPI.currentUser();
                    if (puzzleAPI.cognitoUser == null) {
                      swal('등록한 사용자만이 퍼즐을 게시할 수 있습니다.', { 
                          buttons: {
                            cancel: '계속 퍼즐 만들기',
                            catch: {
                              text: '등록 페이지로 이동',
                              value: 'catch'
                            }
                          }
                      }).then( function(value) {
                        localStorage.removeItem('latestEditedPuzzle');
                        if (value == "catch") window.location.href = "_signUp.html";
                      });
                      return;                   
                    }
                    $.ajax( { type: 'POST', url: puzzleAPI.apiUrl + 'puzzles',
                      headers: {
                        'Authorization' : puzzleAPI.token
                      },
                      data: JSON.stringify(item),
                      success: function(data) {
                        swal('퍼즐을 성공적으로 등록하였습니다.', { 
                          buttons: {
                            cancel: '계속 퍼즐 만들기',
                            catch: {
                              text: '퍼즐 갤러리로 이동',
                              value: 'catch'
                            }
                          }
                        }).then( function(value) {
                          localStorage.removeItem('latestEditedPuzzle');
                          if (value == "catch") window.location.href = "gallery.html";
                        });
                      },
                      fail: function(err) {
                        swal('안에 제목, 내용이 비었거나 퍼즐을 만들지 않았네요. 퍼즐에디터 오른쪽 상단 메뉴를 누르시고 저장하기를 선택해주세요. 다시 시도해보세요.');
                      }
                    });


                  });
                  $(document).ready(function() {
                    $('#summernote').summernote({
                      lang: 'ko-KR',
                      height: 300,                      
                      minHeight: null,
                      maxHeight: null,
                      placeholder: '소개글을 써주세요.'
                    });
                    
                	  var loadingArea= $('#loading-area'),
                	  	  closeBtn= loadingArea.find('.btn'),
            			  term;
                    loadingArea[0].style.opacity= 1;
                    term= setTimeout(function() {
                      loadingArea.remove();
                    }, 10000);
                    closeBtn.on('click', function(e) {
                      clearTimeout(term);
                      loadingArea.remove();
                    });
                	  loadModule('editor');
                  });

                  /* following two functions are necessary to enable or disable keyboard focus to unity webbuild.
                   * otherwise, all keyboard inputs are delivered to unity NOT any web elements.
                   */
                  $(document).on('click', ':not(canvas)', function(e) {  
                    e.stopPropagation();
                    if (Module == null) return;
                    Module.SendMessage("UI", "ToggleInput", 0);
                  });
                  $(document).on('click', 'canvas', function(e) {  
                    e.stopPropagation();
                    if (Module == null) return;
                    Module.SendMessage("UI", "ToggleInput", 1);
                  });
                </script>
              </div>
            </div>
          </div> <!-- end of sm -->
        </div> <!-- end of row -->
      </div> <!-- end of container -->
    </div> <!-- end of page wrapper -->
  


    <!--푸터시작-->
    <footer>
    </footer>
    <!--푸터 끝-->
  </body>
